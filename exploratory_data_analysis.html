<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-binding-2.2.0/leaflet.js"></script>
<script src="site_libs/leaflet-providers-1.13.0/leaflet-providers_1.13.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.2.0/leaflet-providers-plugin.js"></script>
<link href="site_libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="site_libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="site_libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="report.html">Report</a>
</li>
<li>
  <a href="exploratory_data_analysis.html">Exploratory Analysis</a>
</li>
<li>
  <a href="statistical_analysis.html">Statistical Analysis</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:&lt;lq2234@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Lu-Qiu/p8105_final_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Data Analysis</h1>

</div>


<div id="data-cleaning-and-processing" class="section level2">
<h2>Data Cleaning and Processing</h2>
<p>The raw data is a global listing of over 800 volcanic eruptions and
their information. All the variables are compressed in two columns in
the csv file, so when importing the data, we used
<code>read.csv()</code> function to separate them by <code>;</code>, and
set the empty values as <code>NA</code>.</p>
<p>Next, we cleaned the variable names with
<code>janitor::clean_names()</code>, and removed the unwanted variables
(e.g. <code>month</code> and <code>day</code> which are missing for many
eruptions, <code>location</code> which is unnecessary in our study,
variables of total effect which are mostly repetition of volcano effect)
from our dataframe.</p>
<p>Finally, we used <code>mutate()</code> function to make some
necessary adjustments to the variables, including:</p>
<ul>
<li><p>Changed the variable type of <code>flag_tsunami</code> and
<code>flag_earthquake</code> from character to boolean using
<code>case_match()</code>.</p></li>
<li><p>Separated variable <code>coordinates</code> into two numeric
variables <code>lat</code>, <code>long</code> using
<code>separate()</code> and <code>as.numeric()</code>.</p></li>
<li><p>For the loss description variables, changed the <code>NA</code>
values to <code>"None/No Record"</code>, shortened the description
length using <code>case_match()</code> and changed their type from
character to factor using <code>factor()</code>, assigning the levels
according to severity.</p></li>
</ul>
<pre class="r"><code>tidy_df = 
  read.csv(
    &quot;data/significant-volcanic-eruption-database.csv&quot;, sep = &quot;;&quot;, na.strings=c(&quot;&quot;, NA)) |&gt;
  janitor::clean_names() |&gt;
  dplyr::select(
    -c(month, day, location, status, volcano_missing, volcano_missing_description, earthquakes_houses_damaged_description),
    -starts_with(&quot;total&quot;)
    ) |&gt;
  mutate( # change flags to boolean
    flag_tsunami = case_match(flag_tsunami, &quot;Tsunami&quot;~ TRUE, NA ~ FALSE),
    flag_earthquake = case_match(flag_earthquake, &quot;Earthquake&quot;~ TRUE, NA ~ FALSE)
  ) |&gt;
  separate(coordinates, into = c(&quot;lat&quot;, &quot;long&quot;), sep = &quot;,&quot;) |&gt;
  mutate(
    lat = as.numeric(lat), long = as.numeric(long)
  ) |&gt;
  mutate_at(vars(ends_with(&#39;description&#39;)), ~ifelse(is.na(.), &quot;None/No Record&quot;, .)) |&gt;
  mutate( # shorten description
    volcano_deaths_description = case_match(
      volcano_deaths_description,
      &quot;Very Many (~1001 or more deaths)&quot; ~ &quot;Very Many (~1001 or more)&quot;, 
      &quot;Many (~101 to 1000 deaths)&quot; ~ &quot;Many (~101 to 1000)&quot;, 
      &quot;Some (~51 to 100 deaths)&quot; ~ &quot;Some (~51 to 100)&quot;, 
      &quot;Few (~1 to 50 deaths)&quot; ~ &quot;Few (~1 to 50)&quot;,
      &quot;None/No Record&quot; ~ &quot;None/No Record&quot;
    ),
    volcano_injuries_description = case_match(
      volcano_injuries_description,
      &quot;Very Many (~1001 or more deaths)&quot; ~ &quot;Very Many (~1001 or more)&quot;, 
      &quot;Many (~101 to 1000 deaths)&quot; ~ &quot;Many (~101 to 1000)&quot;, 
      &quot;Some (~51 to 100 deaths)&quot; ~ &quot;Some (~51 to 100)&quot;, 
      &quot;Few (~1 to 50 deaths)&quot; ~ &quot;Few (~1 to 50)&quot;,
      &quot;None/No Record&quot; ~ &quot;None/No Record&quot;
    ),
    volcano_damage_description = case_match(
      volcano_damage_description,
      &quot;EXTREME (~$25 million or more)&quot; ~ &quot;EXTREME (~&gt;=$25 million)&quot;, 
      &quot;SEVERE (~&gt;$5 to $24 million)&quot; ~ &quot;SEVERE (~$5 to $24 million)&quot;, 
      &quot;MODERATE (~$1 to $5 million)&quot; ~ &quot;MODERATE (~$1 to $5 million)&quot;, 
      &quot;LIMITED (roughly corresponding to less than $1 million)&quot; ~ &quot;LIMITED (~&lt;$1 million)&quot;,
      &quot;None/No Record&quot; ~ &quot;None/No Record&quot;
    ),
    volcano_houses_destroyed_description = case_match(
      volcano_houses_destroyed_description,
      &quot;Very Many (~1001 or more houses)&quot; ~ &quot;Very Many (~1001 or more)&quot;, 
      &quot;Many (~101 to 1000 houses)&quot; ~ &quot;Many (~101 to 1000)&quot;, 
      &quot;Some (~51 to 100 houses)&quot; ~ &quot;Some (~51 to 100)&quot;, 
      &quot;Few (~1 to 50 houses)&quot; ~ &quot;Few (~1 to 50)&quot;,
      &quot;None/No Record&quot; ~ &quot;None/No Record&quot;
    )
  ) |&gt;
  mutate( # change descriptions to factors w/ levels
    volcano_deaths_description = factor(volcano_deaths_description, levels = c(&quot;Very Many (~1001 or more)&quot;, &quot;Many (~101 to 1000)&quot;, &quot;Some (~51 to 100)&quot;, &quot;Few (~1 to 50)&quot;, &quot;None/No Record&quot;)),
    volcano_injuries_description = factor(volcano_injuries_description, levels = c(&quot;Very Many (~1001 or more)&quot;, &quot;Many (~101 to 1000)&quot;, &quot;Some (~51 to 100)&quot;, &quot;Few (~1 to 50)&quot;, &quot;None/No Record&quot;)),
    volcano_damage_description = factor(volcano_damage_description, levels = c(&quot;EXTREME (~&gt;=$25 million)&quot;, &quot;SEVERE (~$5 to $24 million)&quot;, &quot;MODERATE (~$1 to $5 million)&quot;, &quot;LIMITED (~&lt;$1 million)&quot;, &quot;None/No Record&quot;)),
    volcano_houses_destroyed_description = factor(volcano_houses_destroyed_description, levels = c(&quot;Very Many (~1001 or more)&quot;, &quot;Many (~101 to 1000)&quot;, &quot;Some (~51 to 100)&quot;, &quot;Few (~1 to 50)&quot;, &quot;None/No Record&quot;))
  )

write.csv(tidy_df, &quot;data/volcanic-eruption-final.csv&quot;, row.names=FALSE)</code></pre>
<p>The final dataset used in the analysis has the following key
variables:</p>
<ul>
<li><code>year</code>: the year of eruption</li>
<li><code>flag_tsunami</code>: specifies whether there is a tsunami
accompanying the volcanic eruption</li>
<li><code>flag_earthquake</code>: specifies whether there is an
earthquake accompanying the volcanic eruption</li>
<li><code>volcano_name</code>: the name of the volcano</li>
<li><code>country</code>: the country where the volcano is located</li>
<li><code>elevation</code>: the elevation of the volcano</li>
<li><code>volcano_type</code>: the type of the volcano</li>
<li><code>volcanic_explosivity_index</code>: volcanic explosivity index
of the eruption<br />
</li>
<li><code>volcano_deaths</code>: deaths caused directly by volcanic
eruption<br />
</li>
<li><code>volcano_deaths_description</code>: description of deaths
caused directly by volcanic eruption<br />
</li>
<li><code>volcano_injuries</code>: injuries caused directly by volcanic
eruption<br />
</li>
<li><code>volcano_injuries_description</code>: description of injuries
caused directly by volcanic eruption<br />
</li>
<li><code>volcano_damage_in_m</code>: damage (in million dollars) caused
directly by volcanic eruption<br />
</li>
<li><code>volcano_damage_description</code>: description of damage (in
million dollars) caused directly by volcanic eruption<br />
</li>
<li><code>volcano_houses_destroyed</code>: houses destroyed directly by
volcanic eruption<br />
</li>
<li><code>volcano_houses_destroyed_description</code>: description of
houses destroyed directly by volcanic eruption</li>
<li><code>lat</code>: latitude of the volcano<br />
</li>
<li><code>long</code>: longitude of the volcano</li>
</ul>
</div>
<div id="geographical-distribution-of-volcanic-eruptions"
class="section level2">
<h2>Geographical Distribution of Volcanic Eruptions</h2>
<p>First, we want to figure out which countries or regions are most
prone to volcanic eruptions, so we make an interactive map to display
the geographical distribution of volcanoes.</p>
<pre class="r"><code>geo_df = 
  tidy_df |&gt;
  select(volcano_name, country, volcano_type, elevation, lat, long) |&gt;
  group_by(volcano_name, country, volcano_type, elevation, lat, long) |&gt;
  summarise(eruption_count = n())

geo_df |&gt;
  filter(eruption_count &gt;= 2) |&gt;
  leaflet() |&gt;
  addTiles() |&gt;
  addProviderTiles(providers$CartoDB.Positron) |&gt;
  addMarkers(lat = ~lat, 
             lng = ~long, 
             clusterOptions = markerClusterOptions(),
             label = ~paste(
               &quot;Name: &quot;, volcano_name, &quot;&lt;br&gt;&quot;,
               &quot;Country: &quot;, country, &quot;&lt;br&gt;&quot;,
               &quot;Volcano Type: &quot;, volcano_type, &quot;&lt;br&gt;&quot;,
               &quot;Elevation: &quot;, elevation, &quot;&lt;br&gt;&quot;,
               &quot;Eruption Count: &quot;, eruption_count) |&gt; lapply(htmltools::HTML)) </code></pre>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-531083a1017747b5ed82" style="width:864px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-531083a1017747b5ed82">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org/copyright/\">OpenStreetMap<\/a>,  <a href=\"https://opendatacommons.org/licenses/odbl/\">ODbL<\/a>"}]},{"method":"addProviderTiles","args":["CartoDB.Positron",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[37.62,-8.342000000000001,39.97,50.858,-16.25,-15.4,32.45,10.463,15.63,36.4,32.88,59.37,53.255,3.67,-4.525,37.6,3.138,64.63,61.38,12.77,-41.326,9.202999999999999,40.827,17.36,19.514,12.98,-0.677,43.68,-5.056,-7.2,37.734,14.95,14.473,-7.25,0.8,1.375,64.42,-0.171,-7.13,35.22,63.98,45.374,19.692,-45.9,2.92,-8.058,-8.539999999999999,9.978999999999999,-3.62,2.78,-4.649,-11.75,63.63,-7.93,12.3,19.425,31.93,56.057,42.07,65.73,-6.102,30.43,36.62,-16.829,28.58,-8,-2.751,-8.529999999999999,1.358,-5.358,0.32,-4.1,-0.381,19.475,13.257,-7.542,34.08,32.1,37.12,-15.6,-1.408,-1.52,-38.12,53.42,6.25,35.9,64,34.73,14.381,-5.58,-8.32,-7.32,14.82,15.13,19.023,2.32,-40.59,-4.271,-29.27,-8.125,60.48,-8.42,-5.52,2.28,4.895,-15.78,31.58,38.65,13.736,14.756,36.404,-13.612,-9.130000000000001,-8.108000000000001,54.75,56.653,3.17,-8.51,16.72,13.33,-2.38,46.2,38.789,14.002,-6.77,36.57,-38.82,-7.942,-6.92,-10.38,43.42,30.48,-1.467,32.75,42.53,40.821,-39.42,-37.52,-19.52],[140.28,115.508,140.77,155.55,168.12,167.83,139.77,-84.703,44.08,138.53,131.1,-153.42,158.83,125.5,129.871,140.08,125.491,-17.53,-141.75,124.05,-72.614,124.673,14.139,-93.22799999999999,-103.62,-87.56999999999999,-78.43600000000001,142.88,150.108,109.92,15.004,-24.35,-90.88,108.05,127.325,127.52,-17.33,-78.598,107.83,139.02,-19.7,-121.694,-155.87,-72.97,-76.05,114.242,123.59,-83.852,144.62,125.48,145.964,43.38,-19.05,112.308,-61.63,-155.292,130.87,160.638,140.68,-16.78,105.423,130.22,138.55,168.536,-17.83,113.342,35.902,122.775,124.792,147.12,127.4,145.061,100.473,-155.608,123.685,110.442,139.53,139.85,139.97,-175.63,29.2,29.25,176.5,-168.13,10.5,137.48,-16.65,139.38,-90.601,150.52,121.708,107.73,-61.17,120.35,-98.622,-76.40000000000001,-72.117,152.203,-177.92,114.042,-152.75,116.47,148.121,125.425,-75.322,-71.84999999999999,130.67,-28.08,-89.286,-91.55200000000001,25.396,-172.525,159.82,112.92,-163.97,161.36,98.392,124.148,-62.18,-61.18,147.35,-122.18,15.213,120.993,107.6,137.6,176,112.95,129.125,165.8,142.68,140.32,-78.44199999999999,130.3,140.83,14.426,-71.93000000000001,177.18,169.425],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,{"showCoverageOnHover":true,"zoomToBoundsOnClick":true,"spiderfyOnMaxZoom":true,"removeOutsideVisibleBounds":true,"spiderLegPolylineOptions":{"weight":1.5,"color":"#222","opacity":0.5},"freezeAtZoom":false},null,["Name:  Adatara <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  1718 <br> Eruption Count:  2","Name:  Agung <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  3142 <br> Eruption Count:  2","Name:  Akita-Yake-yama <br> Country:  Japan <br> Volcano Type:  Complex volcano <br> Elevation:  1366 <br> Eruption Count:  2","Name:  Alaid <br> Country:  Russia <br> Volcano Type:  Stratovolcano <br> Elevation:  2339 <br> Eruption Count:  2","Name:  Ambrym <br> Country:  Vanuatu <br> Volcano Type:  Pyroclastic shield <br> Elevation:  1334 <br> Eruption Count:  4","Name:  Aoba <br> Country:  Vanuatu <br> Volcano Type:  Shield volcano <br> Elevation:  1496 <br> Eruption Count:  5","Name:  Aoga-shima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  423 <br> Eruption Count:  2","Name:  Arenal <br> Country:  Costa Rica <br> Volcano Type:  Stratovolcano <br> Elevation:  1657 <br> Eruption Count:  4","Name:  Arhab, Harra of <br> Country:  Yemen <br> Volcano Type:  Volcanic field <br> Elevation:  3100 <br> Eruption Count:  2","Name:  Asama <br> Country:  Japan <br> Volcano Type:  Complex volcano <br> Elevation:  2560 <br> Eruption Count:  18","Name:  Aso <br> Country:  Japan <br> Volcano Type:  Caldera <br> Elevation:  1592 <br> Eruption Count:  16","Name:  Augustine <br> Country:  United States <br> Volcano Type:  Lava dome <br> Elevation:  1252 <br> Eruption Count:  3","Name:  Avachinsky <br> Country:  Russia <br> Volcano Type:  Stratovolcano <br> Elevation:  2741 <br> Eruption Count:  2","Name:  Awu <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1320 <br> Eruption Count:  6","Name:  Banda Api <br> Country:  Pacific Ocean <br> Volcano Type:  Caldera <br> Elevation:  640 <br> Eruption Count:  6","Name:  Bandai <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  1819 <br> Eruption Count:  2","Name:  Banua Wuhu <br> Country:  Indonesia <br> Volcano Type:  Submarine volcano <br> Elevation:  -5 <br> Eruption Count:  3","Name:  Bardarbunga <br> Country:  Iceland <br> Volcano Type:  Stratovolcano <br> Elevation:  2000 <br> Eruption Count:  6","Name:  Bona-Churchill <br> Country:  United States <br> Volcano Type:  Stratovolcano <br> Elevation:  5005 <br> Eruption Count:  2","Name:  Bulusan <br> Country:  Philippines <br> Volcano Type:  Stratovolcano <br> Elevation:  1565 <br> Eruption Count:  4","Name:  Calbuco <br> Country:  Chile <br> Volcano Type:  Stratovolcano <br> Elevation:  2003 <br> Eruption Count:  5","Name:  Camiguin <br> Country:  Philippines <br> Volcano Type:  Stratovolcano <br> Elevation:  1332 <br> Eruption Count:  5","Name:  Campi Flegrei <br> Country:  Italy <br> Volcano Type:  Caldera <br> Elevation:  458 <br> Eruption Count:  3","Name:  Chichon, El <br> Country:  Mexico <br> Volcano Type:  Tuff cone <br> Elevation:  1150 <br> Eruption Count:  4","Name:  Colima <br> Country:  Mexico <br> Volcano Type:  Stratovolcano <br> Elevation:  3850 <br> Eruption Count:  4","Name:  Cosiguina <br> Country:  Nicaragua <br> Volcano Type:  Stratovolcano <br> Elevation:  872 <br> Eruption Count:  2","Name:  Cotopaxi <br> Country:  Ecuador <br> Volcano Type:  Stratovolcano <br> Elevation:  5911 <br> Eruption Count:  6","Name:  Daisetsu <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  2290 <br> Eruption Count:  2","Name:  Dakataua <br> Country:  Papua New Guinea <br> Volcano Type:  Caldera <br> Elevation:  400 <br> Eruption Count:  2","Name:  Dieng Volc Complex <br> Country:  Indonesia <br> Volcano Type:  Complex volcano <br> Elevation:  2565 <br> Eruption Count:  10","Name:  Etna <br> Country:  Italy <br> Volcano Type:  Stratovolcano <br> Elevation:  3350 <br> Eruption Count:  25","Name:  Fogo <br> Country:  Cape Verde <br> Volcano Type:  Stratovolcano <br> Elevation:  2829 <br> Eruption Count:  3","Name:  Fuego <br> Country:  Guatemala <br> Volcano Type:  Stratovolcano <br> Elevation:  3763 <br> Eruption Count:  11","Name:  Galunggung <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2168 <br> Eruption Count:  2","Name:  Gamalama <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1715 <br> Eruption Count:  10","Name:  Gamkonora <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1635 <br> Eruption Count:  2","Name:  Grimsvotn <br> Country:  Iceland <br> Volcano Type:  Caldera <br> Elevation:  1725 <br> Eruption Count:  7","Name:  Guagua Pichincha <br> Country:  Ecuador <br> Volcano Type:  Stratovolcano <br> Elevation:  4784 <br> Eruption Count:  2","Name:  Guntur <br> Country:  Indonesia <br> Volcano Type:  Complex volcano <br> Elevation:  2249 <br> Eruption Count:  3","Name:  Hakone <br> Country:  Japan <br> Volcano Type:  Complex volcano <br> Elevation:  1438 <br> Eruption Count:  5","Name:  Hekla <br> Country:  Iceland <br> Volcano Type:  Stratovolcano <br> Elevation:  1491 <br> Eruption Count:  16","Name:  Hood <br> Country:  United States <br> Volcano Type:  Stratovolcano <br> Elevation:  3426 <br> Eruption Count:  2","Name:  Hualalai <br> Country:  United States <br> Volcano Type:  Shield volcano <br> Elevation:  2523 <br> Eruption Count:  2","Name:  Hudson, Cerro <br> Country:  Chile <br> Volcano Type:  Stratovolcano <br> Elevation:  1905 <br> Eruption Count:  4","Name:  Huila <br> Country:  Colombia <br> Volcano Type:  Stratovolcano <br> Elevation:  5365 <br> Eruption Count:  3","Name:  Ijen <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2799 <br> Eruption Count:  3","Name:  Iliwerung <br> Country:  Indonesia <br> Volcano Type:  Complex volcano <br> Elevation:  1018 <br> Eruption Count:  5","Name:  Irazu <br> Country:  Costa Rica <br> Volcano Type:  Stratovolcano <br> Elevation:  3432 <br> Eruption Count:  2","Name:  Kadovar <br> Country:  Papua New Guinea <br> Volcano Type:  Stratovolcano <br> Elevation:  365 <br> Eruption Count:  2","Name:  Karangetang [Api Siau] <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1784 <br> Eruption Count:  10","Name:  Karkar <br> Country:  Papua New Guinea <br> Volcano Type:  Stratovolcano <br> Elevation:  1839 <br> Eruption Count:  2","Name:  Karthala <br> Country:  Comoros <br> Volcano Type:  Shield volcano <br> Elevation:  2361 <br> Eruption Count:  6","Name:  Katla <br> Country:  Iceland <br> Volcano Type:  Subglacial volcano <br> Elevation:  1512 <br> Eruption Count:  15","Name:  Kelut <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1731 <br> Eruption Count:  18","Name:  Kick-'em-Jenny <br> Country:  Netherlands <br> Volcano Type:  Submarine volcano <br> Elevation:  -177 <br> Eruption Count:  2","Name:  Kilauea <br> Country:  United States <br> Volcano Type:  Shield volcano <br> Elevation:  1222 <br> Eruption Count:  15","Name:  Kirishima <br> Country:  Japan <br> Volcano Type:  Shield volcano <br> Elevation:  1700 <br> Eruption Count:  9","Name:  Kliuchevskoi <br> Country:  Russia <br> Volcano Type:  Stratovolcano <br> Elevation:  4835 <br> Eruption Count:  3","Name:  Komaga-take <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  1140 <br> Eruption Count:  3","Name:  Krafla <br> Country:  Iceland <br> Volcano Type:  Caldera <br> Elevation:  650 <br> Eruption Count:  2","Name:  Krakatau <br> Country:  Indonesia <br> Volcano Type:  Caldera <br> Elevation:  813 <br> Eruption Count:  8","Name:  Kuchinoerabu-jima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  649 <br> Eruption Count:  2","Name:  Kusatsu-Shirane <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  2176 <br> Eruption Count:  4","Name:  Kuwae <br> Country:  Vanuatu <br> Volcano Type:  Caldera <br> Elevation:  -2 <br> Eruption Count:  2","Name:  La Palma <br> Country:  Spain <br> Volcano Type:  Stratovolcano <br> Elevation:  2426 <br> Eruption Count:  2","Name:  Lamongan <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1651 <br> Eruption Count:  2","Name:  Lengai, Ol Doinyo <br> Country:  Tanzania <br> Volcano Type:  Stratovolcano <br> Elevation:  2890 <br> Eruption Count:  4","Name:  Lewotobi <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1703 <br> Eruption Count:  2","Name:  Lokon-Empung <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1580 <br> Eruption Count:  3","Name:  Long Island <br> Country:  Papua New Guinea <br> Volcano Type:  Complex volcano <br> Elevation:  1280 <br> Eruption Count:  2","Name:  Makian <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  1357 <br> Eruption Count:  4","Name:  Manam <br> Country:  Papua New Guinea <br> Volcano Type:  Stratovolcano <br> Elevation:  1807 <br> Eruption Count:  9","Name:  Marapi <br> Country:  Indonesia <br> Volcano Type:  Complex volcano <br> Elevation:  2891 <br> Eruption Count:  2","Name:  Mauna Loa <br> Country:  United States <br> Volcano Type:  Shield volcano <br> Elevation:  4170 <br> Eruption Count:  3","Name:  Mayon <br> Country:  Philippines <br> Volcano Type:  Stratovolcano <br> Elevation:  2462 <br> Eruption Count:  19","Name:  Merapi <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2947 <br> Eruption Count:  27","Name:  Miyake-jima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  815 <br> Eruption Count:  4","Name:  Myojun Knoll <br> Country:  Japan <br> Volcano Type:  Submarine volcano <br> Elevation:  360 <br> Eruption Count:  6","Name:  Nasu <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  1917 <br> Eruption Count:  3","Name:  Niuafo'ou <br> Country:  Tonga <br> Volcano Type:  Shield volcano <br> Elevation:  260 <br> Eruption Count:  2","Name:  Nyamuragira <br> Country:  Congo, DRC <br> Volcano Type:  Shield volcano <br> Elevation:  3058 <br> Eruption Count:  2","Name:  Nyiragongo <br> Country:  Congo, DRC <br> Volcano Type:  Stratovolcano <br> Elevation:  3470 <br> Eruption Count:  3","Name:  Okataina <br> Country:  New Zealand <br> Volcano Type:  Lava dome <br> Elevation:  1111 <br> Eruption Count:  5","Name:  Okmok <br> Country:  United States <br> Volcano Type:  Shield volcano <br> Elevation:  1073 <br> Eruption Count:  2","Name:  Oku Volc Field <br> Country:  Cameroon <br> Volcano Type:  Maar <br> Elevation:  3011 <br> Eruption Count:  2","Name:  On-take <br> Country:  Japan <br> Volcano Type:  Complex volcano <br> Elevation:  3063 <br> Eruption Count:  2","Name:  Oraefajokull <br> Country:  Iceland <br> Volcano Type:  Stratovolcano <br> Elevation:  2119 <br> Eruption Count:  2","Name:  Oshima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  758 <br> Eruption Count:  4","Name:  Pacaya <br> Country:  Guatemala <br> Volcano Type:  Complex volcano <br> Elevation:  2552 <br> Eruption Count:  4","Name:  Pago <br> Country:  Papua New Guinea <br> Volcano Type:  Caldera <br> Elevation:  742 <br> Eruption Count:  4","Name:  Paluweh <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  875 <br> Eruption Count:  6","Name:  Papandayan <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2665 <br> Eruption Count:  2","Name:  Pelee <br> Country:  Martinique <br> Volcano Type:  Stratovolcano <br> Elevation:  1397 <br> Eruption Count:  4","Name:  Pinatubo <br> Country:  Philippines <br> Volcano Type:  Stratovolcano <br> Elevation:  1486 <br> Eruption Count:  6","Name:  Popocatepetl <br> Country:  Mexico <br> Volcano Type:  Stratovolcano <br> Elevation:  5426 <br> Eruption Count:  2","Name:  Purace <br> Country:  Colombia <br> Volcano Type:  Stratovolcano <br> Elevation:  4650 <br> Eruption Count:  2","Name:  Puyehue <br> Country:  Chile <br> Volcano Type:  Stratovolcano <br> Elevation:  2236 <br> Eruption Count:  2","Name:  Rabaul <br> Country:  Papua New Guinea <br> Volcano Type:  Pyroclastic shield <br> Elevation:  688 <br> Eruption Count:  6","Name:  Raoul Island <br> Country:  New Zealand <br> Volcano Type:  Stratovolcano <br> Elevation:  516 <br> Eruption Count:  2","Name:  Raung <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  3332 <br> Eruption Count:  5","Name:  Redoubt <br> Country:  United States <br> Volcano Type:  Stratovolcano <br> Elevation:  3108 <br> Eruption Count:  2","Name:  Rinjani <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  3726 <br> Eruption Count:  2","Name:  Ritter Island <br> Country:  Papua New Guinea <br> Volcano Type:  Stratovolcano <br> Elevation:  140 <br> Eruption Count:  3","Name:  Ruang <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  725 <br> Eruption Count:  2","Name:  Ruiz <br> Country:  Colombia <br> Volcano Type:  Stratovolcano <br> Elevation:  5321 <br> Eruption Count:  3","Name:  Sabancaya <br> Country:  Peru <br> Volcano Type:  Stratovolcano <br> Elevation:  5967 <br> Eruption Count:  2","Name:  Sakura-jima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  1117 <br> Eruption Count:  14","Name:  San Jorge <br> Country:  Portugal <br> Volcano Type:  Fissure vent <br> Elevation:  1053 <br> Eruption Count:  3","Name:  San Salvador <br> Country:  El Salvador <br> Volcano Type:  Stratovolcano <br> Elevation:  1893 <br> Eruption Count:  3","Name:  Santa Maria <br> Country:  Guatemala <br> Volcano Type:  Stratovolcano <br> Elevation:  3772 <br> Eruption Count:  4","Name:  Santorini <br> Country:  Greece <br> Volcano Type:  Shield volcano <br> Elevation:  329 <br> Eruption Count:  8","Name:  Savai'i <br> Country:  Samoa <br> Volcano Type:  Shield volcano <br> Elevation:  1858 <br> Eruption Count:  2","Name:  Savo <br> Country:  Solomon Is. <br> Volcano Type:  Stratovolcano <br> Elevation:  510 <br> Eruption Count:  2","Name:  Semeru <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  3676 <br> Eruption Count:  23","Name:  Shishaldin <br> Country:  United States <br> Volcano Type:  Stratovolcano <br> Elevation:  2857 <br> Eruption Count:  2","Name:  Shiveluch <br> Country:  Russia <br> Volcano Type:  Stratovolcano <br> Elevation:  3283 <br> Eruption Count:  3","Name:  Sinabung <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2460 <br> Eruption Count:  10","Name:  Sirung <br> Country:  Indonesia <br> Volcano Type:  Complex volcano <br> Elevation:  862 <br> Eruption Count:  2","Name:  Soufriere Hills <br> Country:  Montserrat <br> Volcano Type:  Stratovolcano <br> Elevation:  915 <br> Eruption Count:  6","Name:  Soufriere St. Vincent <br> Country:  St. Vincent & the Grenadines <br> Volcano Type:  Stratovolcano <br> Elevation:  1220 <br> Eruption Count:  3","Name:  St. Andrew Strait <br> Country:  Papua New Guinea <br> Volcano Type:  Complex volcano <br> Elevation:  270 <br> Eruption Count:  2","Name:  St. Helens <br> Country:  United States <br> Volcano Type:  Stratovolcano <br> Elevation:  2549 <br> Eruption Count:  3","Name:  Stromboli <br> Country:  Italy <br> Volcano Type:  Stratovolcano <br> Elevation:  926 <br> Eruption Count:  11","Name:  Taal <br> Country:  Philippines <br> Volcano Type:  Stratovolcano <br> Elevation:  400 <br> Eruption Count:  8","Name:  Tangkubanparahu <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2084 <br> Eruption Count:  3","Name:  Tate-yama <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  2621 <br> Eruption Count:  4","Name:  Taupo <br> Country:  New Zealand <br> Volcano Type:  Caldera <br> Elevation:  760 <br> Eruption Count:  4","Name:  Tengger Caldera <br> Country:  Indonesia <br> Volcano Type:  Stratovolcano <br> Elevation:  2329 <br> Eruption Count:  2","Name:  Teon <br> Country:  Pacific Ocean <br> Volcano Type:  Stratovolcano <br> Elevation:  655 <br> Eruption Count:  2","Name:  Tinakula <br> Country:  Solomon Is. <br> Volcano Type:  Stratovolcano <br> Elevation:  851 <br> Eruption Count:  4","Name:  Tokachi <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  2077 <br> Eruption Count:  2","Name:  Tori-shima <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  403 <br> Eruption Count:  2","Name:  Tungurahua <br> Country:  Ecuador <br> Volcano Type:  Stratovolcano <br> Elevation:  5023 <br> Eruption Count:  11","Name:  Unzen <br> Country:  Japan <br> Volcano Type:  Complex volcano <br> Elevation:  1500 <br> Eruption Count:  5","Name:  Usu <br> Country:  Japan <br> Volcano Type:  Stratovolcano <br> Elevation:  731 <br> Eruption Count:  7","Name:  Vesuvius <br> Country:  Italy <br> Volcano Type:  Complex volcano <br> Elevation:  1281 <br> Eruption Count:  18","Name:  Villarrica <br> Country:  Chile <br> Volcano Type:  Stratovolcano <br> Elevation:  2847 <br> Eruption Count:  4","Name:  White Island <br> Country:  New Zealand <br> Volcano Type:  Stratovolcano <br> Elevation:  321 <br> Eruption Count:  2","Name:  Yasur <br> Country:  Vanuatu <br> Volcano Type:  Stratovolcano <br> Elevation:  361 <br> Eruption Count:  5"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-45.9,65.73],"lng":[-177.92,177.18]}},"evals":[],"jsHooks":[]}</script>
<p>We can notice that most volcanoes are located along the peripheries
of continents. This pattern is a result of the tectonic plate boundaries
where volcanic activity is often concentrated.</p>
<p>We can also notice that the majority of volcanoes are located along
the Pacific Ocean. This area is known as the “Ring of Fire”. It traces
boundaries between several tectonic plates—including the Pacific, Juan
de Fuca, Cocos, Indian-Australian, Nazca, North American, and Philippine
Plates.</p>
<pre class="r"><code>country1 =
  geo_df |&gt;
  group_by(country)|&gt;
  summarise(n = n()) |&gt;
  arrange(desc(n)) |&gt;
  head(5) |&gt;
  ggplot(aes(x = reorder(country, -n), y = n, fill = country)) +
  geom_bar(stat = &quot;identity&quot;, width = 0.6) +
  labs(title = &quot;Top Five Countries with the Most Volcanoes&quot;,
       x = &quot;Country&quot;,
       y = &quot;Number of Volcanoes&quot;) 


country2 =
  geo_df |&gt;
  group_by(country)|&gt;
  summarise(n = sum(eruption_count)) |&gt;
  arrange(desc(n)) |&gt;
  head(5) |&gt;
  ggplot(aes(x = reorder(country, -n), y = n, fill = country)) +
  geom_bar(stat = &quot;identity&quot;, width = 0.6) +
  labs(title = &quot;Top Five Countries with the Most Volcanic Eruptions&quot;,
       x = &quot;Country&quot;,
       y = &quot;Number of Eruptions&quot;) 

plot_grid(country1, country2, ncol = 1)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-3-1.png" width="864" /></p>
<p>The top five countries with the most volcanoes are: Indonesia, Japan,
United States, Papua New Guinea and Russia.<br />
The top five countries with the most volcanic eruptions are: Indonesia,
Japan, Italy, Iceland and United States.</p>
<hr />
</div>
<div id="time-distribution-of-volcanic-eruptions"
class="section level2">
<h2>Time Distribution of Volcanic Eruptions</h2>
<pre class="r"><code># Tidy data for plotting
voc_year &lt;- tidy_df%&gt;%
  group_by(year,volcanic_explosivity_index)%&gt;%
  summarise(count = n())

voc_year$period &lt;- ifelse(voc_year$year &lt; 0, &quot;Before Christ&quot;,
ifelse(voc_year$year &lt;= 1000, &quot;0-1000&quot;,
ifelse(voc_year$year &lt;= 1500, &quot;1000-1500&quot;,
ifelse(voc_year$year &lt;= 1899, &quot;1500-1900&quot;,
ifelse(tidy_df$year &lt;= 1999, &quot;20th century&quot;, &quot;21st century&quot;))))) 

# Change the variable type to factor
voc_year$period &lt;- factor(voc_year$period, levels = c(&quot;Before Christ&quot;, &quot;0-1000&quot;, &quot;1000-1500&quot;, &quot;1500-1900&quot;, &quot;20th century&quot;,&quot;21st century&quot;))</code></pre>
<div id="volcanic-eruption-counts-over-time-periods"
class="section level3">
<h3>Volcanic Eruption Counts Over Time Periods</h3>
<pre class="r"><code>expo &lt;- voc_year |&gt;
  select(period,volcanic_explosivity_index) |&gt;
  group_by(period,volcanic_explosivity_index) |&gt;
  summarise(count = n())

# Plotting
ggplot(expo,aes(x = period, y = count,fill = volcanic_explosivity_index)) +
  geom_bar(stat=&quot;identity&quot;, position=&quot;stack&quot;) +
   labs(
    x = &quot;Period&quot;,
    y = &quot;Count&quot;,
    title = &quot;Volcanic Eruption Counts Over Time Periods&quot;
  )</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-5-1.png" width="864" />
The above plot illustrates the total number of volcanic eruptions across
different time periods. The period from 1500 to 1900 recorded the
highest number of volcanic eruptions, totaling around 250.</p>
<p>The number of eruptions in the 20th century is approximately equal to
the total number of eruptions from 1500 to 1900, with most eruptions’
VEI ranging from 2 to 5. The total number of eruptions across the
remaining four time periods is nearly identical. For eruptions occurring
before Christ or from 0 to 1000 B.C., those with a VEI of 6 constitute
the main type of eruption. This is probably because only the most
colossal volcanic eruptions were documented during this ancient era.</p>
</div>
<div id="analysis-of-deaths-and-injuries-over-time"
class="section level3">
<h3>Analysis of Deaths and Injuries Over Time</h3>
<pre class="r"><code>time_df &lt;- tidy_df |&gt;
  filter(year &gt; 1900) |&gt;
  mutate(
    volcano_deaths = replace(volcano_deaths, is.na(volcano_deaths), 0),
    volcano_injuries = replace(volcano_injuries, is.na(volcano_injuries), 0),
    volcano_damage_in_m = replace(volcano_damage_in_m, is.na(volcano_damage_in_m), 0),
    volcano_houses_destroyed = replace(volcano_houses_destroyed, is.na(volcano_houses_destroyed), 0),
    year = as.character(year)
  ) |&gt;
group_by(year) |&gt;
  summarize(
    total_deaths = sum(volcano_deaths,na.rm = TRUE),
    total_injuries = sum(volcano_injuries,na.rm = TRUE),
    total_damage = sum(volcano_damage_in_m,na.rm = TRUE),
    total_house_destruction = sum(volcano_houses_destroyed,na.rm = TRUE)
  )


ggplot(time_df, aes(x = as.numeric(year))) +
  geom_line(aes(y = total_deaths, color = &quot;Deaths&quot;), size = 1) +
  geom_line(aes(y = total_injuries, color = &quot;Injuries&quot;), size = 1) +
  labs(
    title = &quot;Analysis of Toal Deaths and Total Injuries Over Time&quot;,
    x = &quot;Year&quot;,
    y = &quot;Count&quot;,
    color = &quot;Variable&quot;
  )</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-6-1.png" width="864" />
As for the number of deaths, it reached its climax at over 30000 around
1900. As time progressed, the number of deaths fluctuated between 0 and
5000 until around 1985, when it reached another peak at about 25000.
After that, the number of deaths dropped and continued to fluctuate
between 0 and 1500.</p>
<p>When it comes to the number of injuries, however, the number did not
fluctuate as drastically as the number of death. It remained stable from
1900 to around1985. After hitting its pick at 10000 in around 1985, the
number went down and continued to remain stable.</p>
</div>
<div id="analysis-of-damage-and-houses-destroyed-over-time"
class="section level3">
<h3>Analysis of Damage and Houses Destroyed Over Time</h3>
<pre class="r"><code>ggplot(time_df, aes(x = as.numeric(year))) +
  geom_line(aes(y = total_damage, color = &quot;Damage&quot;), size = 1) +
  geom_line(aes(y = total_house_destruction, color = &quot;Houses Destroyed&quot;), size = 1)+
  labs(
    title = &quot;Analysis of Damage and Houses Destroyed Over Time&quot;,
    x = &quot;Year&quot;,
    y = &quot;Count&quot;,
    color = &quot;Variable&quot;
  ) </code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-7-1.png" width="864" />
As for the number of houses destroyed, the most significant increase in
damage and houses destroyed occurred between 1900 and 1925. The number
then remained stable and fluctuated slightly until the 2020s, when the
number of houses destroyed drastically fluctuated ranging from 0 to
3300.</p>
<p>In light of the number of damage, it remained stable over time and
slightly fluctuated around 1975 and the 2010s respectively.</p>
<hr />
</div>
</div>
<div id="factors-influencing-volcanic-losses-numeric"
class="section level2">
<h2>Factors Influencing Volcanic Losses (Numeric)</h2>
<p>In this section, we aim to explore the impact of various factors(the
occurrence of tsunami and earthquake, the type of volcano, the volcanic
explosivity index and elevation) on casualties and property losses
resulting from volcanic eruptions.</p>
<pre class="r"><code>numeric_df = 
  tidy_df |&gt; 
  select(year,flag_tsunami,flag_earthquake, elevation, 
         volcano_type, volcanic_explosivity_index,
         volcano_injuries, volcano_deaths, volcano_damage_in_m, volcano_houses_destroyed) |&gt;
  mutate(
    flag_tsunami = factor(flag_tsunami),
    flag_earthquake = factor(flag_earthquake),
    volcanic_explosivity_index = factor(volcanic_explosivity_index))</code></pre>
<div id="tsunami" class="section level3">
<h3>Tsunami</h3>
<pre class="r"><code>par(mfrow = c(2,2))

# volcano_injuries vs flag_tsunami 
tsunami_injuries = 
  numeric_df |&gt;
  filter(!is.na(volcano_injuries)) |&gt;
  ggplot(aes(x = flag_tsunami, y = log(volcano_injuries), group = flag_tsunami, fill = flag_tsunami)) +
  geom_boxplot() +
  labs(title = &quot;Injuries vs Tsunami&quot;, x = &quot;Tsunami Occurrence&quot;, y = &quot;ln_Injuries&quot;)


# volcano_deaths vs flag_tsunami
tsunami_deaths = 
  numeric_df |&gt;
  filter(!is.na(volcano_deaths)) |&gt;
  ggplot(aes(x = flag_tsunami, y = log(volcano_deaths), group = flag_tsunami, fill = flag_tsunami)) +
  geom_boxplot() +
  labs(title = &quot;Deaths vs Tsunami&quot;, x = &quot;Tsunami Occurrence&quot;, y = &quot;ln_Deaths&quot;) 


# damage vs flag_tsunami
tsunami_damage = 
  numeric_df |&gt;
  filter(!is.na(volcano_damage_in_m)) |&gt;
  ggplot(aes(x = flag_tsunami, y = log(volcano_damage_in_m), group = flag_tsunami, fill = flag_tsunami)) +
  geom_boxplot() +
  labs(title = &quot;Damage vs Tsunami&quot;, x = &quot;Tsunami Occurrence&quot;, y = &quot;ln_Damage(money in million)&quot;) 


# volcano_houses_destroyed vs flag_tsunami 
tsunami_houses_destroyed = 
  numeric_df |&gt;
  filter(!is.na(volcano_houses_destroyed)) |&gt;
  ggplot(aes(x = flag_tsunami, y = log(volcano_houses_destroyed), group = flag_tsunami, fill = flag_tsunami)) +
  geom_boxplot() +
  labs(title = &quot;Houses Destroyed vs Tsunami&quot;, x = &quot;Tsunami Occurrence&quot;, y = &quot;ln_Houses Destroyed&quot;)

grid.arrange(tsunami_deaths, tsunami_injuries, tsunami_damage, tsunami_houses_destroyed, ncol = 2)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-9-1.png" width="864" /></p>
<p>The box plots above indicate a noticeable influence of tsunami
occurrence on the volcanic losses. The tsunami effects triggered by
volcanic activities are likely to contribute to an increase in both
casualties and property damage.</p>
</div>
<div id="earthquake" class="section level3">
<h3>Earthquake</h3>
<pre class="r"><code>par(mfrow = c(2,2))

# volcano_injuries vs flag_earthquake
earthquake_injuries = 
  numeric_df |&gt;
  filter(!is.na(volcano_injuries)) |&gt;
  ggplot(aes(x = flag_earthquake, y = log(volcano_injuries), group = flag_earthquake, fill = flag_earthquake)) +
  geom_boxplot() +
  labs(title = &quot;Injuries vs Earthquake&quot;, x = &quot;Earthquake Occurrence&quot;, y = &quot;ln_Injuries&quot;) 


#volcano_deaths vs flag_earthquake
earthquake_deaths = 
  numeric_df |&gt;
  filter(!is.na(volcano_deaths)) |&gt;
  ggplot(aes(x = flag_earthquake, y = log(volcano_deaths), group = flag_earthquake, fill = flag_earthquake)) +
  geom_boxplot() +
  labs(title = &quot;Deaths vs Earthquake&quot;, x = &quot;Earthquake Occurrence&quot;, y = &quot;ln_Deaths&quot;)


#damage vs flag_earthquake 
earthquake_damage = 
  numeric_df |&gt;
  filter(!is.na(volcano_damage_in_m)) |&gt;
  ggplot(aes(x = flag_earthquake, y = log(volcano_damage_in_m), group = flag_earthquake, fill = flag_earthquake)) +
  geom_boxplot() +
  labs(title = &quot;Damage vs Earthquake&quot;, x = &quot;Earthquake Occurrence&quot;, y = &quot;ln_Damage(money in million)&quot;) 


#volcano_houses_destroyed vs flag_earthquake
earthquake_houses_destroyed = 
  numeric_df |&gt;
  filter(!is.na(volcano_houses_destroyed)) |&gt;
  ggplot(aes(x = flag_earthquake, y = log(volcano_houses_destroyed), group = flag_earthquake,fill = flag_earthquake)) +
  geom_boxplot() +
  labs(title = &quot;Houses Destroyed vs Earthquake&quot;, x = &quot;Earthquake Occurrence&quot;, y = &quot;ln_Houses Destroyed&quot;) 


grid.arrange(earthquake_deaths, earthquake_injuries, earthquake_damage, earthquake_houses_destroyed, ncol = 2)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-10-1.png" width="864" /></p>
<p>The above box plots indicate that when volcanic eruptions trigger
volcanic earthquakes, there is a generally noticeable increase in
casualties and property damage compared to situations where volcanic
earthquakes are not triggered.</p>
</div>
<div id="volcano-type" class="section level3">
<h3>Volcano Type</h3>
<pre class="r"><code>par(mfrow = c(2,2))

# volcano_injuries vs volcano_type
type_injuries =
  numeric_df |&gt;
  filter(!is.na(volcano_injuries)) |&gt;
  ggplot(aes(x = reorder(volcano_type, volcano_injuries, median), y = log(volcano_injuries), group = volcano_type, fill = volcano_type)) +
  geom_boxplot() +
  labs(title = &quot;Injuries vs Volcano Type&quot;, x = &quot;Volcano Type&quot;, y = &quot;ln_Injuries&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;none&quot;)


# volcano_deaths vs volcano_type
type_deaths = 
  numeric_df |&gt;
  filter(!is.na(volcano_deaths)) |&gt;
  ggplot(aes(x = reorder(volcano_type, volcano_deaths, median), y = log(volcano_deaths), group = volcano_type, fill = volcano_type)) +
  geom_boxplot() +
  labs(title = &quot;Deaths vs Volcano Type&quot;, x = &quot;Volcano Type&quot;, y = &quot;ln_Deaths&quot;)+
  theme(axis.text.x = element_text(angle = 60, hjust = 1), legend.position = &quot;none&quot;)


# damage vs volcano_type
type_damage =
  numeric_df |&gt;
  filter(!is.na(volcano_damage_in_m)) |&gt;
  ggplot(aes(x = reorder(volcano_type, volcano_damage_in_m, median), y = log(volcano_damage_in_m), group = volcano_type, fill = volcano_type)) +
  geom_boxplot() +
  labs(title = &quot;Damage vs Volcano Type&quot;, x = &quot;Volcano Type&quot;, y = &quot;ln_Damage&quot;)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;none&quot;)


# volcano_houses_destroyed vs volcano_type
type_houses_destroyed =
  numeric_df |&gt;
  filter(!is.na(volcano_houses_destroyed)) |&gt;
  ggplot(aes(x = reorder(volcano_type, volcano_houses_destroyed, median), y = log(volcano_houses_destroyed), group = volcano_type, fill = volcano_type)) +
  geom_boxplot() +
  labs(title = &quot;Houses Destroyed vs Volcano Type&quot;, x = &quot;Volcano Type&quot;, y = &quot;ln_Houses Destroyed&quot;)+
  theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = &quot;none&quot;)

grid.arrange(type_deaths, type_injuries, type_damage, type_houses_destroyed, ncol = 2)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-11-1.png" width="864" /></p>
<ul>
<li>The above box plots indicate that there is no clear correlation
between the types of volcanoes and the volcanic losses. Some volcanoes
that result in significant property damage during eruptions do not
necessarily lead to a high number of casualties (which may be related to
missing values).</li>
<li>Among these volcanoes, eruptions of the “Maar” type lead to the most
severe casualties, while eruptions of the “Stratovolcano” type
comparatively result in more substantial property damage.</li>
</ul>
</div>
<div id="vei" class="section level3">
<h3>VEI</h3>
<pre class="r"><code>par(mfrow = c(2,2))

# volcano_injuries vs VEI
VEI_injuries = 
  numeric_df |&gt;
  filter(!is.na(volcano_injuries),
         !is.na(volcanic_explosivity_index)) |&gt;
  ggplot(aes(x = volcanic_explosivity_index, y = log(volcano_injuries), group = volcanic_explosivity_index, fill = volcanic_explosivity_index)) +
  geom_boxplot() +
  labs(title = &quot;Injuries vs VEI&quot;, x = &quot;VEI (level)&quot;, y = &quot;ln_Injuries&quot;)+
  theme(legend.position = &quot;none&quot;)


# volcano_deaths vs VEI
VEI_deaths = 
  numeric_df |&gt;
  filter(!is.na(volcano_deaths),
         !is.na(volcanic_explosivity_index)) |&gt;
  ggplot(aes(x = volcanic_explosivity_index, y = log(volcano_deaths), group = volcanic_explosivity_index, fill = volcanic_explosivity_index)) +
  geom_boxplot() +
  labs(title = &quot;Deaths vs VEI&quot;, x = &quot;VEI (level)&quot;, y = &quot;ln_Deaths&quot;)+
  theme(legend.position = &quot;none&quot;)


# damage vs VEI 
VEI_damage =
  numeric_df |&gt;
  filter(!is.na(volcano_damage_in_m),
         !is.na(volcanic_explosivity_index)) |&gt;
  ggplot(aes(x = volcanic_explosivity_index, y = log(volcano_damage_in_m), group = volcanic_explosivity_index, fill = volcanic_explosivity_index)) +
  geom_boxplot() +
  labs(title = &quot;Damage vs VEI&quot;, x = &quot;VEI (level)&quot;, y = &quot;ln_Damage&quot;) +
  theme(legend.position = &quot;none&quot;)


# volcano_houses_destroyed vs VEI
VEI_houses_destroyed =
  numeric_df |&gt;
  filter(!is.na(volcano_houses_destroyed),
         !is.na(volcanic_explosivity_index)) |&gt;
  ggplot(aes(x = volcanic_explosivity_index, y = log(volcano_houses_destroyed), group = volcanic_explosivity_index, fill = volcanic_explosivity_index)) +
  geom_boxplot() +
  labs(title = &quot;Houses Destroyed vs VEI&quot;, x = &quot;VEI (level)&quot;, y = &quot;ln_Houses Destroyed&quot;) +
  theme(legend.position = &quot;none&quot;)


grid.arrange(VEI_deaths, VEI_injuries, VEI_damage, VEI_houses_destroyed, ncol = 2)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-12-1.png" width="864" /></p>
<p>The above box plots show that with the increase in the volcanic
explosivity index, there is a general upward trend in casualties and
property damage caused by volcanic eruptions. In other words, as the
energy of the volcanic eruption increases, the casualties and losses
become more severe.</p>
</div>
<div id="elevation" class="section level3">
<h3>Elevation</h3>
<pre class="r"><code>par(mfrow = c(2,2))

# volcano_injuries vs elevation
elevation_injuries = 
  numeric_df |&gt;
  filter(!is.na(volcano_injuries),
         !is.na(elevation)) |&gt;
  ggplot(aes(x = elevation, y = log(volcano_injuries))) +
  geom_point() +
  geom_smooth(se = FALSE)+
  labs(title = &quot;Injuries VS Elevation&quot;, x = &quot;Elevation&quot;, y = &quot;ln_Injuries&quot;)+
  theme(legend.position = &quot;none&quot;)

# volcano_deaths vs elevation
elevation_deaths = 
  numeric_df |&gt;
  filter(!is.na(volcano_deaths),
         !is.na(elevation)) |&gt;
  ggplot(aes(x = elevation, y = log(volcano_deaths))) +
  geom_point() +
  geom_smooth(se = FALSE)+
  labs(title = &quot;Deaths vs Elevation&quot;, x = &quot;Elevation&quot;, y = &quot;ln_Deaths&quot;)+
  theme(legend.position = &quot;none&quot;)


# damage vs elevation 
elevation_damage =
  numeric_df |&gt;
  filter(!is.na(volcano_damage_in_m),
         !is.na(elevation)) |&gt;
  ggplot(aes(x = elevation, y = log(volcano_damage_in_m))) +
  geom_point() +
  geom_smooth(se = FALSE)+
  labs(title = &quot;Damage vs Elevation&quot;, x = &quot;Elevation&quot;, y = &quot;ln_Damage&quot;) +
  theme(legend.position = &quot;none&quot;)


# volcano_houses_destroyed vs elevation
elevation_houses_destroyed =
  numeric_df |&gt;
  filter(!is.na(volcano_houses_destroyed),
         !is.na(elevation)) |&gt;
  ggplot(aes(x = elevation, y = log(volcano_houses_destroyed))) +
  geom_point() +
  geom_smooth(se = FALSE)+
  labs(title = &quot;Houses Destroyed vs Elevation&quot;, x = &quot;Elevation&quot;, y = &quot;ln_Houses Destroyed&quot;) +
  theme(legend.position = &quot;none&quot;)


grid.arrange(elevation_deaths, elevation_injuries, elevation_damage, elevation_houses_destroyed, ncol = 2)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-13-1.png" width="864" /></p>
<p>The above plots show that there is no significant correlation between
the elevation of volcanoes and the number of injuries, damage, or houses
destroyed by volcanic eruption. However, it is noticeable that volcanoes
at higher elevations tend to result in a greater number of deaths, and
this trend becomes more pronounced when the volcano’s elevation exceeds
5000 meters.</p>
<hr />
</div>
</div>
<div id="factors-influencing-volcanic-losses-descriptive"
class="section level2">
<h2>Factors Influencing Volcanic Losses (Descriptive)</h2>
<p>Using bar charts, we can take a look at the severity levels of
casualties and damages from volcanic eruptions with different factors
involved.</p>
<p>Considering the problem with missing data and our interest of study,
we will filter out the “None/No Record” values when examining loss
levels and focus on the observations with losses recorded.</p>
<pre class="r"><code>cad_df = tidy_df |&gt;
  select(year, flag_tsunami, flag_earthquake,
         volcano_type, volcanic_explosivity_index, 
         volcano_deaths_description, volcano_injuries_description,
         volcano_damage_description, volcano_houses_destroyed_description,
         volcano_deaths, volcano_injuries, 
         volcano_damage_in_m, volcano_houses_destroyed,
         elevation)</code></pre>
<div id="tsunami-1" class="section level3">
<h3>Tsunami</h3>
<pre class="r"><code>p1 = cad_df|&gt;
  filter(volcano_deaths_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_tsunami, fill = volcano_deaths_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Deaths&quot;,
       x = &quot;Tsunami&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p2 = cad_df|&gt;
  filter(volcano_injuries_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_tsunami, fill = volcano_injuries_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Injuries&quot;,
       x = &quot;Tsunami&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p3 = cad_df|&gt;
  filter(volcano_damage_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_tsunami, fill = volcano_damage_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Damages&quot;,
       x = &quot;Tsunami&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p4 = cad_df|&gt;
  filter(volcano_houses_destroyed_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_tsunami, fill = volcano_houses_destroyed_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Houses Destroyed&quot;,
       x = &quot;Tsunami&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div id="severity-of-losses-vs-tsunami" class="section level4">
<h4>Severity of Losses vs Tsunami</h4>
<pre class="r"><code>legends_1 = get_legend(
  p1 + 
    guides(fill = guide_legend(nrow = 1, title=&quot;Losses&quot;), byrow=TRUE) +
    theme(legend.position = &quot;bottom&quot;) +
    theme(legend.title=element_blank())
)
legends_2 = get_legend(
  p3 + 
    guides(fill = guide_legend(nrow = 2, title=&quot;Damages&quot;), byrow=TRUE) +
    theme(legend.position = &quot;bottom&quot;) +
    theme(legend.title=element_blank())
)
mylegends = plot_grid(legends_1, legends_2, nrow = 2)

par(mfrow = c(2,2))

#grid.arrange(p1, p2, p3, p4, ncol = 2)
grid.arrange(
  arrangeGrob(p1, p2, p3, p4, nrow = 1), 
  mylegends, 
  nrow = 2, heights=c(10, 3))</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-15-1.png" width="864" /></p>
<p>We can see that in general, for volcanic eruptions with casualties
and damages, the occurrence of tsunami will increase the severity of the
losses.</p>
</div>
</div>
<div id="earthquake-1" class="section level3">
<h3>Earthquake</h3>
<pre class="r"><code>p1 = cad_df|&gt;
  filter(volcano_deaths_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_earthquake, fill = volcano_deaths_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Deaths&quot;,
       x = &quot;Earthquake&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p2 = cad_df|&gt;
  filter(volcano_injuries_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_earthquake, fill = volcano_injuries_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Injuries&quot;,
       x = &quot;Earthquake&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p3 = cad_df|&gt;
  filter(volcano_damage_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_earthquake, fill = volcano_damage_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Damages&quot;,
       x = &quot;Earthquake&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p4 = cad_df|&gt;
  filter(volcano_houses_destroyed_description != &quot;None/No Record&quot;) |&gt;
  ggplot(aes(x = flag_earthquake, fill = volcano_houses_destroyed_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Houses Destroyed&quot;,
       x = &quot;Earthquake&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div id="severity-of-losses-vs-earthquake" class="section level4">
<h4>Severity of Losses vs Earthquake</h4>
<pre class="r"><code>par(mfrow = c(2,2))

#grid.arrange(p1, p2, p3, p4, ncol = 2)
grid.arrange(
  arrangeGrob(p1, p2, p3, p4, nrow = 1), 
  mylegends, 
  nrow = 2, heights=c(10, 3))</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-16-1.png" width="864" /></p>
<p>We can see that in general, for volcanic eruptions with casualties
and damages, the occurrence of earthquakes will increase the severity of
the losses.</p>
</div>
</div>
<div id="vei-1" class="section level3">
<h3>VEI</h3>
<pre class="r"><code>p1 = cad_df|&gt;
  filter(
    volcano_deaths_description != &quot;None/No Record&quot;,
    !is.na(volcanic_explosivity_index)
    ) |&gt;
  ggplot(
    aes(x = factor(volcanic_explosivity_index), fill = volcano_deaths_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Deaths&quot;,
       x = &quot;VEI&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p2 = cad_df|&gt;
  filter(
    volcano_injuries_description != &quot;None/No Record&quot;,
    !is.na(volcanic_explosivity_index)
    ) |&gt;
  ggplot(
    aes(x = factor(volcanic_explosivity_index), fill = volcano_injuries_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Injuries&quot;,
       x = &quot;VEI&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p3 = cad_df|&gt;
  filter(
    volcano_damage_description != &quot;None/No Record&quot;,
    !is.na(volcanic_explosivity_index)
    ) |&gt;
  ggplot(
    aes(x = factor(volcanic_explosivity_index), fill = volcano_damage_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Damages&quot;,
       x = &quot;VEI&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)

p4 = cad_df|&gt;
  filter(
    volcano_houses_destroyed_description != &quot;None/No Record&quot;,
    !is.na(volcanic_explosivity_index)
    ) |&gt;
  ggplot(aes(
    x = factor(volcanic_explosivity_index), 
    fill = volcano_houses_destroyed_description)) +
  geom_bar(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Houses Destroyed&quot;,
       x = &quot;VEI&quot;,
       y = &quot;Proportion&quot;) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div id="severity-of-losses-vs-vei" class="section level4">
<h4>Severity of Losses vs VEI</h4>
<pre class="r"><code>par(mfrow = c(2,2))

grid.arrange(
  arrangeGrob(p1, p2, p3, p4, nrow = 2), 
  mylegends, 
  nrow = 2, heights=c(10, 3))</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-17-1.png" width="864" /></p>
<p>We can see that as VEI increases, the proportion of volcanic
eruptions with more severe losses also increases, especially for
casualty levels. This indicates that eruptions with a large VEI is
likely to be more deadly.</p>
</div>
</div>
<div id="elevation-1" class="section level3">
<h3>Elevation</h3>
<pre class="r"><code>elv_df = cad_df|&gt;
  filter(!is.na(elevation)) |&gt;
  mutate(
    height = ifelse(elevation &lt; 0, &quot;&lt; 0&quot;,
      ifelse(elevation &lt;= 1000, &quot;0-1000&quot;,
        ifelse(elevation &lt;= 2000, &quot;1000-2000&quot;,
          ifelse(elevation &lt;= 3000, &quot;2000-3000&quot;,
            ifelse(elevation &lt;= 4000, &quot;3000-4000&quot;,
              ifelse(elevation &lt;= 5000, &quot;4000-5000&quot;, &quot;&gt; 5000&quot;)))))) ) |&gt;
  mutate(height = factor(height, levels = c(&quot;&lt; 0&quot;, &quot;0-1000&quot;, &quot;1000-2000&quot;, &quot;2000-3000&quot;, &quot;3000-4000&quot;, &quot;4000-5000&quot;, &quot;&gt; 5000&quot;)))


p1 = elv_df |&gt;
  filter(
    volcano_deaths_description != &quot;None/No Record&quot;,
    ) |&gt;
  ggplot(
    aes(x = height, fill = volcano_deaths_description)) +
  geom_histogram(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Deaths&quot;,
       x = &quot;Elevation (m)&quot;,
       y = &quot;Proportion&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)

p2 = elv_df |&gt;
  filter(
    volcano_injuries_description != &quot;None/No Record&quot;,
    ) |&gt;
  ggplot(
    aes(x = height, fill = volcano_injuries_description)) +
  geom_histogram(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Injuries&quot;,
       x = &quot;Elevation (m)&quot;,
       y = &quot;Proportion&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)

p3 = elv_df |&gt;
  filter(
    volcano_damage_description != &quot;None/No Record&quot;,
    ) |&gt;
  ggplot(
    aes(x = height, fill = volcano_damage_description)) +
  geom_histogram(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Damages&quot;,
       x = &quot;Elevation (m)&quot;,
       y = &quot;Proportion&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)

p4 = elv_df |&gt;
  filter(
    volcano_houses_destroyed_description != &quot;None/No Record&quot;,
    ) |&gt;
  ggplot(
    aes(x = height, fill = volcano_houses_destroyed_description)) +
  geom_histogram(stat = &quot;count&quot;, position = &quot;fill&quot;) +
  geom_text(stat = &quot;count&quot;,
            aes(label = ..count..),
            position = position_fill(vjust = 0.5)) +
  labs(title = &quot;Houses Destroyed&quot;,
       x = &quot;Elevation (m)&quot;,
       y = &quot;Proportion&quot;) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  theme(legend.position = &quot;none&quot;)</code></pre>
<div id="severity-of-losses-vs-elevation" class="section level4">
<h4>Severity of Losses vs Elevation</h4>
<pre class="r"><code>par(mfrow = c(2,2))

grid.arrange(
  arrangeGrob(p1, p2, p3, p4, nrow = 2), 
  mylegends, 
  nrow = 2, heights=c(10, 3))</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-18-1.png" width="864" /></p>
<p>In terms of deaths, eruptions of volcanoes with an elevation over
5000 meters seem to have more severe results. However, for other types
of losses, there don’t seem to be a significant association between the
severity levels and the elevation. This echoes the results in the
previous analysis of numeric losses.</p>
<hr />
</div>
</div>
</div>
<div id="iceland-volcanic-activity-analysis" class="section level2">
<h2>Iceland Volcanic Activity Analysis</h2>
<pre class="r"><code>iceland_volcanic_data &lt;- tidy_df %&gt;%
  filter(country == &quot;Iceland&quot;)

ggplot(iceland_volcanic_data, aes(x = year, fill = as.factor(-year))) +
  geom_histogram(bins = 30, color = &quot;darkgray&quot;) +
  theme_minimal() +
  theme(legend.position = &quot;none&quot;) + 
  labs(title = &quot;Distribution of Volcanic Eruptions in Iceland Over Time&quot;,
       x = &quot;Year&quot;,
       y = &quot;Number of Eruptions&quot;)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-19-1.png" width="864" /></p>
<p>The above plot shows the number of volcanic eruptions in Iceland over
several centuries. The data suggests an increase in recorded eruptions
over time, particularly around the late 1700s. However the increasing
trend in later years could be attributed to better documentation as well
as an actual increase in volcanic activity.</p>
<pre class="r"><code>iceland_volcanic_data %&gt;%
  count(volcano_type) %&gt;%
  arrange(desc(n)) %&gt;%
  mutate(volcano_type = factor(volcano_type, levels = volcano_type)) %&gt;%
  ggplot(aes(x = volcano_type, y = n, fill = volcano_type)) + 
  geom_col() + 
  theme_minimal() +
  labs(title = &quot;Prevalence of Different Volcano Types in Iceland&quot;,
       x = &quot;Volcano Type&quot;,
       y = &quot;Count&quot;) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-20-1.png" width="864" /></p>
<p>The above plot indicates that stratovolcanoes are the most prevalent
volcano type in Iceland, suggesting varied and complex volcanic
activity.</p>
<pre class="r"><code>iceland_volcanic_data |&gt;
  mutate(VEI = factor(volcanic_explosivity_index, levels = 1:6)) |&gt;
  ggplot(aes(x = VEI, fill = fct_rev(VEI))) +
  geom_bar() +
  scale_fill_viridis_d(na.value = &quot;gray&quot;)+
  theme_minimal() +
  labs(title = &quot;Distribution of Volcanic Explosivity Index (VEI) in Iceland&quot;,
       x = &quot;VEI&quot;,
       y = &quot;Count&quot;)</code></pre>
<p><img src="exploratory_data_analysis_files/figure-html/unnamed-chunk-21-1.png" width="864" /></p>
<p>The above plot shows that eruptions with a Volcanic Explosivity Index
of 3 and 4 are most common in Iceland, indicating moderate explosivity
is typical for Icelandic eruptions.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
